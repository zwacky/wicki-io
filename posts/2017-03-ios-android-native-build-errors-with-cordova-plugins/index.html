<!DOCTYPE html>
<html><head>
  <title>iOS &amp; Android Native Build Errors with Cordova Plugins</title>
  <base href="/" />
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400|Playfair+Display:300,400,700" rel="stylesheet" />
  
  <link rel="stylesheet" href="/styles/main.min.css" integrity="" media="screen" />
  <link rel="canonical" href="https://wicki.io/posts/2017-03-ios-android-native-build-errors-with-cordova-plugins/" />
  <link rel="icon" type="image/x-icon" href='https://wicki.io/images/favicon.png' />
  
  <meta charset="utf-8" />
  <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=5" />
  <meta name="keywords" content="[cordova]" />

  <meta property="og:site_name" content="Wicki.io" />
  <meta property="og:title" content="iOS &amp; Android Native Build Errors with Cordova Plugins" name="title" />
  <meta property="og:description" content="A short compilation of some iOS &amp; Android native build errors." name="description" />
  <meta property="og:url" content="https://wicki.io/posts/2017-03-ios-android-native-build-errors-with-cordova-plugins/" />
  <meta property="og:image" content='https://wicki.io/images/logo.png' />
  <meta property="og:type" content='article' />

  <meta name="author" content="Simon Wicki" />
  <meta name="twitter:site" content="@zwacky" />
  <meta name="twitter:creator" content="@zwacky" />
  <meta name="twitter:title" content="iOS &amp; Android Native Build Errors with Cordova Plugins"/>
  <meta name="twitter:description" content="A short compilation of some iOS &amp; Android native build errors."/>

  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#fff" />
</head>
<body><nav class="nav">
  <div class="container">
    <div class="nav__list">
      
      <a href="/" class="nav--brand" style="overflow: hidden;">
        <img src="images/logo.png" alt="W" width="38" />
      </a>
      <div>
        <a href="/#work" class="nav__list__item">Work</a>
        <a href="/#projects" class="nav__list__item">Projects</a>
        
        <a
          href="/posts"
          class="nav__list__item active"
          >Blog</a
        >
        <a
          class="d-none d-sm-inline nav__list__item nav__list__item--mail"
          href="mailto:simon@wicki.io"
          class="nav__list__item nav__list__item--mail"
        >
          Contact
        </a>
        <a
          class="d-inline d-sm-none nav__list__item nav__list__item--mail"
          href="mailto:simon@wicki.io"
        >
          <img
            src="/images/svg/envelope.svg"
            alt="Contact"
            title="Contact"
            style="height: 18px; position: relative; top: -2px;"
          />
        </a>
      </div>
    </div>
  </div>
</nav>
<div id="content">

<div class="container" style="padding-top: 180px;">
  <div class="row">
    <div class="col-lg-8 offset-lg-2">
      <h1>iOS &amp; Android Native Build Errors with Cordova Plugins</h1>
      <div style="margin-bottom: 20px;">
        
          March 20, 2017
        
      </div>

      <p>Lately I encountered some native build errors that slowed me down quite a bit. Here is an overview of some of them, their issue and solution which might save you some time if you come across one of the following native errors:</p>
<ul>
<li><strong>iOS:</strong> ‘GoogleCloudMessaging.h’ file not found</li>
<li><strong>iOS:</strong> Duplicate Symbols</li>
<li><strong>Android:</strong> safeparcel.AbstractSafeParcelable not found</li>
<li><strong>Android:</strong> Force Close due to phonegap-push-plugin</li>
</ul>
<figure>
    <img src="/posts/2017-03-ios-android-native-build-errors-with-cordova-plugins/native-build-error.png"
         alt="Native build error"/> 
</figure>

<h2 id="ios-googlecloudmessagingh-file-not-found">iOS: ‘GoogleCloudMessaging.h’ file not found</h2>
<pre><code>error: ‘GoogleCloudMessaging.h’ file not found
#import &quot;GoogleCloudMessaging.h&quot;
Lexical or Preprocessor Issue
&gt; ‘GoogleCloudMessaging.h’ file not found
&gt; PushPlugin.m
</code></pre><h3 id="issue">Issue</h3>
<p>Cordova supports CocoaPods since 4.3.0. The issue here is that 2 pods don’t load correctly and you need to add them manually in your ./platforms/ios/Podfile like in the solution.</p>
<h3 id="solution">Solution</h3>
<pre><code>platform :ios, '7.0'
target 'JustWatch' do
	pod 'GoogleCloudMessaging'
	pod 'GGLInstanceID'
end
</code></pre><p>…and then in ./platforms/ios do a <code>pod install</code>.</p>
<hr>
<h2 id="ios-duplicate-symbols">iOS: Duplicate Symbols</h2>
<pre><code>ld: 270 duplicate symbols for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
** BUILD FAILED **
</code></pre><h3 id="issue-1">Issue:</h3>
<p><a href="https://github.com/phonegap/phonegap-plugin-push">phonegap-plugin-push</a> and cordova-plugin-googleplus have common dependencies, but both add them separately which causes the duplicate symbols.</p>
<h3 id="solution-1">Solution:</h3>
<ul>
<li>Open your project with XCode.</li>
<li>Go to &ldquo;Build Phases&rdquo; and access to &ldquo;Link Binary With Libraries&rdquo;</li>
<li>Remove these libraries:</li>
</ul>
<pre><code>- libGTMSessionFetcher_core.a
- libGTMSessionFetcher_full.a
- libGTM_AddressBook.a
- libGTM_core.a
- libGTM_GTMURLBuilder.a
- libGTM_iPhone.a
- libGTM_KVO.a
- libGTM_Regex.a
- libGTM_StringEncoding.a
- libGTM_SystemVersion.a
</code></pre><p>As suggested here by @ideatia: <a href="https://github.com/phonegap/phonegap-plugin-push/issues/449#issuecomment-223557733">https://github.com/phonegap/phonegap-plugin-push/issues/449#issuecomment-223557733</a></p>
<hr>
<h2 id="android-safeparcelabstractsafeparcelable-not-found">Android: safeparcel.AbstractSafeParcelable not found</h2>
<pre><code>PluginUtil.java:135: error: cannot access AbstractSafeParcelable
    Builder builder = LatLngBounds.builder();
                                  ^
    class file for com.google.android.gms.common.internal.safeparcel.AbstractSafeParcelable not found
</code></pre><h3 id="issue-2">Issue:</h3>
<p>Two plugins are using the same play services dependencies but with different versions that are explicitly set and therefore can’t use two different dependency versions.</p>
<h3 id="solution-2">Solution:</h3>
<p>Unpin the play-services-map and play-services-location by adding this Cordova plugin fork directly:
ionic plugin add <a href="https://github.com/zwacky/cordova-plugin-googlemaps">https://github.com/zwacky/cordova-plugin-googlemaps</a></p>
<hr>
<h2 id="android-force-close-due-to-phonegap-push-plugin">Android: Force Close due to phonegap-push-plugin</h2>
<pre><code>E/AndroidRuntime( 2059): FATAL EXCEPTION: pool-1-thread-3
E/AndroidRuntime( 2059): Process: com.justwatch.justwatch, PID: 2059
E/AndroidRuntime( 2059): java.lang.NoSuchMethodError: No static method getNoBackupFilesDir(Landroid/content/Context;)Ljava/io/File; in class Lcom/google/android/gms/common/util/zzw; or its super classes (declaration of ‘com.google.android.gms.common.util.zzw’ appears in /data/app/com.justwatch.justwatch-1/base.apk)
E/AndroidRuntime( 2059): at com.google.android.gms.iid.zzd.zzkq(Unknown Source)
E/AndroidRuntime( 2059): at com.google.android.gms.iid.zzd.&lt;init&gt;(Unknown Source)
E/AndroidRuntime( 2059): at com.google.android.gms.iid.zzd.&lt;init&gt;(Unknown Source)
E/AndroidRuntime( 2059): at com.google.android.gms.iid.InstanceID.zza(Unknown Source)
E/AndroidRuntime( 2059): at com.google.android.gms.iid.InstanceID.getInstance(Unknown Source)
E/AndroidRuntime( 2059): at com.adobe.phonegap.push.PushPlugin$1.run(PushPlugin.java:74)
E/AndroidRuntime( 2059): at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1112)
E/AndroidRuntime( 2059): at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:587)
E/AndroidRuntime( 2059): at java.lang.Thread.run(Thread.java:818)
</code></pre><h3 id="issue-3">Issue:</h3>
<p><code>Google Play</code> GCM dependencies have changed here which made the <a href="https://github.com/phonegap/phonegap-plugin-push">phonegap-push-plugin</a> have to adjust accordingly, otherwise wrong method signatures will be called which causes a force close.</p>
<h3 id="solution-3">Solution:</h3>
<p>Update to latest <a href="https://github.com/phonegap/phonegap-plugin-push">phonegap-push-plugin</a> version or basically everything after 1.8.4.</p>


      
      <hr /><div class="about__bio">
  <div class="about__bio__profile">
    
    
    <img
      src="/images/me_huc890d15b6e9f2ce8978e9aa27127dd5e_67203_350x0_resize_q75_box.jpg"
      alt="Simon Wicki"
      class="about__bio__profile--image"
    />
    
  </div>

  <div>
    <div class="title" style="font-size: 1.5rem; margin-top: 0">
      Simon Wicki
    </div>
    <div
      style="
        font-weight: 400;
        color: inherit;
        font-size: inherit;
        margin-top: 0;
        margin-bottom: 1rem;
      "
    >
      Previously Head of Frontend at
      <a href="https://www.justwatch.com" rel="noopener" target="_blank"
        >JustWatch</a
      >. Co-organizer of
      <a
        href="https://www.meetup.com/Ionic-Berlin/"
        rel="noopener"
        target="_blank"
        >@IonicBerlin</a
      >. Creator of
      <a href="https://notyfy.co" rel="noopener" target="_blank"
        >https://notyfy.co</a
      >. I love building things, coffee and books. Berlin.
    </div>
    <div style="font-weight: 400">
      Ionic <span style="margin: 0 6px">·</span> VueJS
      <span style="margin: 0 6px">·</span> Angular
      <span style="margin: 0 6px">·</span>
      Cordova / Capacitor
    </div>
    <div style="margin-top: 6px">
      <a
        href="https://medium.com/@zwacky"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/medium.svg"
          alt="Medium"
          title="Medium"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="https://twitter.com/zwacky"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/twitter.svg"
          alt="Twitter"
          title="Twitter"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="https://github.com/zwacky"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/github.svg"
          alt="GitHub"
          title="GitHub"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="https://www.linkedin.com/in/simon-w-490b8617a"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/linkedin.svg"
          alt="LinkedIn"
          title="LinkedIn"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="mailto:simon@wicki.io"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/envelope.svg"
          alt="LinkedIn"
          title="LinkedIn"
          style="height: 18px; opacity: 0.6"
        />
      </a>
    </div>
  </div>
</div>

    </div>
  </div>
</div>


        </div><footer class="footer">
	<div class="container">
		<div style="display: flex; justify-content: space-between;">
			<div class="footer__shoutout">
				Made with Hugo and 
				<span style="white-space: nowrap;">
					
					
					<img src="/images/svg/heart.svg" alt="Love" style="opacity: 0.5; height: 16px;" />
				</span>
			</div>
			<div class="footer__links">
				<a href="/privacy">Privacy Policy</a>
				<a href="/imprint">Impressum</a>
			</div>
		</div>
	</div>
</footer>
<script type="application/javascript">
  window.ga =
    window.ga ||
    function () {
      (ga.q = ga.q || []).push(arguments);
    };
  ga.l = +new Date();
  ga("create", "UA-176737760-1", "auto");
  ga("set", "anonymizeIp", true);
  ga("set", "allowAdFeatures", false);
  ga("set", "allowAdPersonalizationSignals", false);
  ga("send", "pageview");
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>


    </body>
</html>
