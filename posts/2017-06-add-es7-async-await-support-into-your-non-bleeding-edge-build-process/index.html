<!DOCTYPE html>
<html><head>
  <title>Add ES7 Async/Await Support for your Webapp in 3 Easy Steps</title>
  <base href="/" />
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400|Playfair+Display:300,400,700" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400|Playfair+Display:300,400,700" />
  
  <link rel="stylesheet" href="/styles/main.min.css" integrity="" media="screen" />
  <link rel="canonical" href="https://wicki.io/posts/2017-06-add-es7-async-await-support-into-your-non-bleeding-edge-build-process/" />
  <link rel="icon" type="image/x-icon" href='https://wicki.io/images/favicon.png' />
  
  <meta charset="utf-8" />
  <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=5" />
  <meta name="keywords" content="[es7, async await]" />

  <meta property="og:site_name" content="Wicki.io" />
  <meta property="og:title" content="Add ES7 Async/Await Support for your Webapp in 3 Easy Steps" name="title" />
  <meta property="og:description" content="Step by step guide to add async/await in your build flow." name="description" />
  <meta property="og:url" content="https://wicki.io/posts/2017-06-add-es7-async-await-support-into-your-non-bleeding-edge-build-process/" />
  <meta property="og:image" content='https://wicki.io/images/logo.png' />
  <meta property="og:type" content='article' />

  <meta name="author" content="Simon Wicki" />
  <meta name="twitter:site" content="@zwacky" />
  <meta name="twitter:creator" content="@zwacky" />
  <meta name="twitter:title" content="Add ES7 Async/Await Support for your Webapp in 3 Easy Steps"/>
  <meta name="twitter:description" content="Step by step guide to add async/await in your build flow."/>

  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#fff" />
</head>
<body><nav class="nav">
  <div class="container">
    <div class="nav__list">
      
      <a href="/" class="nav--brand" style="overflow: hidden;">
        <img src="images/logo.png" alt="W" width="38" />
      </a>
      <div>
        <a href="/#work" class="nav__list__item">Work</a>
        <a href="/#projects" class="nav__list__item">Projects</a>
        
        <a
          href="/posts"
          class="nav__list__item active"
          >Blog</a
        >
        <a
          class="d-none d-sm-inline nav__list__item nav__list__item--mail"
          href="mailto:simon@wicki.io"
          class="nav__list__item nav__list__item--mail"
        >
          Contact
        </a>
        <a
          class="d-inline d-sm-none nav__list__item nav__list__item--mail"
          href="mailto:simon@wicki.io"
        >
          <img
            src="/images/svg/envelope.svg"
            alt="Contact"
            title="Contact"
            style="height: 18px; position: relative; top: -2px;"
          />
        </a>
      </div>
    </div>
  </div>
</nav>
<div id="content">

<div class="container" style="padding-top: 180px;">
  <div class="row">
    <div class="col-lg-8 offset-lg-2">
      <h1>Add ES7 Async/Await Support for your Webapp in 3 Easy Steps</h1>
      <div style="margin-bottom: 20px;">
        
          June 24, 2017
        
      </div>

      <figure>
    <img src="/posts/2017-06-add-es7-async-await-support-into-your-non-bleeding-edge-build-process/caniuse-async-await.png"
         alt="Async / await compatibility"/> <figcaption>
            <p>Nearly all evergreen browsers support Async/Await natively</p>
        </figcaption>
</figure>

<p>Async/Await has been around the block already some time. Now that it is in stage-4 since July 2016 (<a href="https://tc39.github.io/process-document/">stage finished</a> in the ECMAScript proposals) and <a href="http://caniuse.com/#search=async-functions">nearly all evergreen browsers</a> support it natively, too (except IE is late to the party as usual ðŸ˜ª) â€” itâ€™s definitely time to take a second look.</p>
<h2 id="tldr-i-want-asyncawait-support-nao1">TL;DR I WANT ASYNC/AWAIT SUPPORT NAO!!1</h2>
<ul>
<li>use <a href="https://github.com/babel/babel-preset-env">babel-preset-env</a></li>
<li><strong>yarn add regenerator or npm install regenerator</strong></li>
<li>add <strong>node_modules/regenerator-runtime/runtime.js</strong> (10.7kb minified) into your bundle</li>
</ul>
<h2 id="1-requirements">#1 Requirements</h2>
<h3 id="11-babel">#1.1 Babel</h3>
<p>Forget <strong>preset-stage-0</strong>, <strong>babel-plugin-syntax-async-functions</strong> or whatever you can still find on outdated resources. Just use <a href="https://github.com/babel/babel-preset-env">babel-preset-env</a>.</p>
<p>Your <strong>.babelrc</strong> could look like this for the bare minimum to work (add your fancy plugins and more if needed):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;presets&#34;</span>: [
    [
      <span style="color:#e6db74">&#34;env&#34;</span>,
      {
        <span style="color:#f92672">&#34;targets&#34;</span>: {
          <span style="color:#f92672">&#34;browsers&#34;</span>: [<span style="color:#e6db74">&#34;last 2 versions&#34;</span>, <span style="color:#e6db74">&#34;IE &gt;= 9&#34;</span>]
        }
      }
    ]
  ]
}
</code></pre></div><p>If youâ€™re like me, then you canâ€™t just forget about Internet Explorer â‰¥ 9. babel-preset-env lets you specify a <a href="https://github.com/ai/browserslist">browserlist config</a> that calculates your needs and then automatically takes care of all the needed babel plugins.</p>
<p><strong>Note:</strong> The babel plugins do not bloat your bundle file. Polyfills do:</p>
<h3 id="12-polyfills">#1.2 Polyfills</h3>
<blockquote>
<p>An argument could be made for the transform to inject an import for <strong>babel-regenerator-runtime</strong> automatically, but generally Babel has shied away from automatically injecting imports since there is no guarantee that the user will be using a module system, so the global route was taken. (<a href="https://github.com/babel/babel/issues/3825#issuecomment-245406852">from GitHub Issue December 2015</a>)</p>
</blockquote>
<p>Babel has shied away of automagically adding polyfills for generators. Therefore you need to add your own polyfill. There is a <a href="https://www.npmjs.com/package/babel-polyfill">babel-polyfill</a> that adds all possible polyfills and has a proud size of 97kb minified. If you only need the generator polyfill â€” which is needed for async/await â€” then you can just use <a href="https://github.com/facebook/regenerator">facebook/regenerator</a>, which is used by babel-polyfill anyway.</p>
<ul>
<li><strong>yarn add regenerator</strong> or <strong>npm install regenerator &ndash;save</strong> (no dev dependency because it will be injected into your frontend bundle)</li>
<li>add <strong>node_modules/regenerator-runtime/runtime.js</strong> (10.7kb minified) into your bundle</li>
</ul>
<p>Or donâ€™t use a polyfill at all.</p>
<p>If you have set your browser targeting to <strong>chrome &gt;= 39</strong> then you simply will use the native generators and will never make use of the polyfill. But then again, youâ€™ll save 10kb minified here. Might be easier to add the polyfill and later on make the webapp available for IE9.</p>
<h2 id="2-linting-eslint">#2 Linting (ESLint)</h2>
<p>If youâ€™re still using ES6 to write JavaScript, then you probably came across <a href="http://eslint.org/">ESLint</a>. It also comes with a neat <a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint">VS Code extension</a>, that will read your .eslintrc.json correctly and lint accordingly.</p>
<p>You need to tell your .eslintrc.json config, that youâ€™re now playing with the big tools and tell it to lint for ECMAScript version 8:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;env&#34;</span>: {
    <span style="color:#f92672">&#34;browser&#34;</span>: <span style="color:#66d9ef">true</span>,
    <span style="color:#f92672">&#34;commonjs&#34;</span>: <span style="color:#66d9ef">true</span>,
    <span style="color:#f92672">&#34;es6&#34;</span>: <span style="color:#66d9ef">true</span>,
    <span style="color:#f92672">&#34;node&#34;</span>: <span style="color:#66d9ef">true</span>
  },
  <span style="color:#f92672">&#34;parserOptions&#34;</span>: {
    <span style="color:#f92672">&#34;ecmaVersion&#34;</span>: <span style="color:#ae81ff">8</span>
  },
  <span style="color:#f92672">&#34;rules&#34;</span>: {}
}
</code></pre></div>

      
      <hr /><div class="about__bio">
  <div class="about__bio__profile">
    
    
    <img
      src="/images/me_huc890d15b6e9f2ce8978e9aa27127dd5e_67203_350x0_resize_q75_box.jpg"
      alt="Simon Wicki"
      class="about__bio__profile--image"
    />
    
  </div>

  <div>
    <div class="title" style="font-size: 1.5rem; margin-top: 0">
      Simon Wicki
    </div>
    <div
      style="
        font-weight: 400;
        color: inherit;
        font-size: inherit;
        margin-top: 0;
        margin-bottom: 1rem;
      "
    >
      Previously Head of Frontend at
      <a href="https://www.justwatch.com" rel="noopener" target="_blank"
        >JustWatch</a
      >. Co-organizer of
      <a
        href="https://www.meetup.com/Ionic-Berlin/"
        rel="noopener"
        target="_blank"
        >@IonicBerlin</a
      >. Creator of
      <a href="https://notyfy.co" rel="noopener" target="_blank"
        >https://notyfy.co</a
      >. I love building things, coffee and books. Berlin.
    </div>
    <div style="font-weight: 400">
      Ionic <span style="margin: 0 6px">Â·</span> VueJS
      <span style="margin: 0 6px">Â·</span> Angular
      <span style="margin: 0 6px">Â·</span>
      Cordova / Capacitor
    </div>
    <div style="margin-top: 6px">
      <a
        href="https://medium.com/@zwacky"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/medium.svg"
          alt="Medium"
          title="Medium"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="https://twitter.com/zwacky"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/twitter.svg"
          alt="Twitter"
          title="Twitter"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="https://github.com/zwacky"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/github.svg"
          alt="GitHub"
          title="GitHub"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="https://www.linkedin.com/in/simon-w-490b8617a"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/linkedin.svg"
          alt="LinkedIn"
          title="LinkedIn"
          style="height: 18px; opacity: 0.6"
        />
      </a>
      <a
        href="mailto:simon@wicki.io"
        target="_blank"
        rel="noopener"
        class="no-border"
        style="margin-right: 10px"
      >
        <img
          src="images/svg/envelope.svg"
          alt="LinkedIn"
          title="LinkedIn"
          style="height: 18px; opacity: 0.6"
        />
      </a>
    </div>
  </div>
</div>

    </div>
  </div>
</div>


        </div><footer class="footer">
	<div class="container">
		<div style="display: flex; justify-content: space-between;">
			<div class="footer__shoutout">
				Made with Hugo and 
				<span style="white-space: nowrap;">
					
					
					<img src="/images/svg/heart.svg" alt="Love" style="opacity: 0.5; height: 16px;" />
				</span>
			</div>
			<div class="footer__links">
				<a href="/privacy">Privacy Policy</a>
				<a href="/imprint">Impressum</a>
			</div>
		</div>
	</div>
</footer>
    </body>
</html>
